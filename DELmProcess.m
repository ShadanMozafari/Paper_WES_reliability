clear;
clc;
cd ('C:\Users\shmoz\OneDrive - Danmarks Tekniske Universitet\Paper 2\DTU 10MW_turb sampling\20samples\10ms\Lognormal Turb\lowTI');
% load('Mx_blade.mat','Mx');
load('Mx_Tbase.mat','Mx_Tbase');
% Mx_blade_sorted=zeros(60000,2000);
Mx_Tbase_sorted=zeros(60000,2000);
digitsOld=digits(50);
INDEX=[4
5
15
27
49
71
93
116
138
160
182
204
227
237
249
271
293
315
338
360
382
404
426
449
459
471
493
515
537
560
582
604
626
648
671
681
693
715
737
759
782
804
826
848
870
893
903
915
937
959
981
1004
1026
1048
1070
1092
1116
1126
1138
1160
1182
1204
1227
1249
1271
1293
1315
1338
1348
1360
1382
1404
1426
1449
1471
1493
1515
1537
1560
1570
1582
1604
1626
1648
1671
1693
1715
1737
1759
1782
1792
1804
1826
1848
1870
1893
1915
1937
1959
1981
6
26
28
50
72
94
117
139
161
183
205
228
248
250
272
294
316
339
361
383
405
427
450
470
472
494
516
538
561
583
605
627
649
672
692
694
716
738
760
783
805
827
849
871
894
914
916
938
960
982
1005
1027
1049
1071
1093
1115
1117
1137
1139
1161
1183
1205
1228
1250
1272
1294
1316
1339
1359
1361
1383
1405
1427
1450
1472
1494
1516
1538
1561
1581
1583
1605
1627
1649
1672
1694
1716
1738
1760
1783
1803
1805
1827
1849
1871
1894
1916
1938
1960
1982
7
29
37
51
73
95
118
140
162
184
206
229
251
259
273
295
317
340
362
384
406
428
451
473
481
495
517
539
562
584
606
628
650
673
695
703
717
739
761
784
806
828
850
872
895
917
925
939
961
983
1006
1028
1050
1072
1094
1118
1140
1148
1162
1184
1206
1226
1229
1251
1273
1295
1317
1340
1362
1370
1384
1406
1428
1451
1473
1495
1517
1539
1562
1584
1592
1606
1628
1650
1673
1695
1717
1739
1761
1784
1806
1814
1828
1850
1872
1895
1917
1939
1961
1983
8
30
48
52
74
96
119
141
163
185
207
230
252
270
274
296
318
341
363
385
407
429
452
474
492
496
518
540
563
585
607
629
651
674
696
714
718
740
762
785
807
829
851
873
896
918
936
940
962
984
1007
1029
1051
1073
1095
1119
1141
1159
1163
1185
1207
1230
1252
1274
1296
1318
1337
1341
1363
1381
1385
1407
1429
1452
1474
1496
1518
1540
1563
1585
1603
1607
1629
1651
1674
1696
1718
1740
1762
1785
1807
1825
1829
1851
1873
1896
1918
1940
1962
1984
9
31
53
59
75
97
120
142
164
186
208
231
253
275
281
297
319
342
364
386
408
430
453
475
497
503
519
541
564
586
608
630
652
675
697
719
725
741
763
786
808
830
852
874
897
919
941
947
963
985
1008
1030
1052
1074
1096
1120
1142
1164
1170
1186
1208
1231
1253
1275
1297
1319
1342
1364
1386
1392
1408
1430
1448
1453
1475
1497
1519
1541
1564
1586
1608
1614
1630
1652
1675
1697
1719
1741
1763
1786
1808
1830
1836
1852
1874
1897
1919
1941
1963
1985
10
32
54
70
76
98
121
143
165
187
209
232
254
276
292
298
320
343
365
387
409
431
454
476
498
514
520
542
565
587
609
631
653
676
698
720
736
742
764
787
809
831
853
875
898
920
942
958
964
986
1009
1031
1053
1075
1097
1121
1143
1165
1181
1187
1209
1232
1254
1276
1298
1320
1343
1365
1387
1403
1409
1431
1454
1476
1498
1520
1542
1559
1565
1587
1609
1625
1631
1653
1676
1698
1720
1742
1764
1787
1809
1831
1847
1853
1875
1898
1920
1942
1964
1986
11
33
55
77
81
99
122
144
166
188
210
233
255
277
299
303
321
344
366
388
410
432
455
477
499
521
525
543
566
588
610
632
654
677
699
721
743
747
765
788
810
832
854
876
899
921
943
965
969
987
1010
1032
1054
1076
1098
1122
1144
1166
1188
1192
1210
1233
1255
1277
1299
1321
1344
1366
1388
1410
1414
1432
1455
1477
1499
1521
1543
1566
1588
1610
1632
1636
1654
1670
1677
1699
1721
1743
1765
1788
1810
1832
1854
1858
1876
1899
1921
1943
1965
1987
12
34
56
78
92
100
123
145
167
189
211
234
256
278
300
314
322
345
367
389
411
433
456
478
500
522
536
544
567
589
611
633
655
678
700
722
744
758
766
789
811
833
855
877
900
922
944
966
980
988
1011
1033
1055
1077
1099
1123
1145
1167
1189
1203
1211
1234
1256
1278
1300
1322
1345
1367
1389
1411
1425
1433
1456
1478
1500
1522
1544
1567
1589
1611
1633
1647
1655
1678
1700
1722
1744
1766
1781
1789
1811
1833
1855
1869
1877
1900
1922
1944
1966
1988
13
35
57
79
101
103
124
146
168
190
212
235
257
279
301
323
325
346
368
390
412
434
457
479
501
523
545
547
568
590
612
634
656
679
701
723
745
767
769
790
812
834
856
878
901
923
945
967
989
991
1012
1034
1056
1078
1100
1124
1146
1168
1190
1212
1214
1235
1257
1279
1301
1323
1346
1368
1390
1412
1434
1436
1457
1479
1501
1523
1545
1568
1590
1612
1634
1656
1658
1679
1701
1723
1745
1767
1790
1812
1834
1856
1878
1880
1892
1901
1923
1945
1967
1989
3
14
36
58
80
102
114
125
147
169
191
213
236
258
280
302
324
336
347
369
391
413
435
458
480
502
524
546
558
569
591
613
635
657
680
702
724
746
768
780
791
813
835
857
879
902
924
946
968
990
1002
1013
1035
1057
1079
1101
1125
1147
1169
1191
1213
1225
1236
1258
1280
1302
1324
1347
1369
1391
1413
1435
1447
1458
1480
1502
1524
1546
1569
1591
1613
1635
1657
1669
1680
1702
1724
1746
1768
1791
1813
1835
1857
1879
1891
1902
1924
1946
1968
1990
16
38
60
82
104
115
126
127
149
171
193
215
238
260
282
304
326
348
349
371
393
415
437
460
482
504
526
548
570
571
593
615
637
659
682
704
726
748
770
792
793
815
837
859
881
904
926
948
970
992
1014
1015
1037
1059
1081
1103
1127
1149
1171
1193
1215
1237
1238
1260
1282
1304
1326
1349
1371
1393
1415
1437
1459
1460
1482
1504
1526
1548
1571
1593
1615
1637
1659
1681
1682
1704
1726
1748
1770
1793
1815
1837
1859
1881
1903
1904
1926
1948
1970
1992
17
39
61
83
105
128
137
150
172
194
216
226
239
261
283
305
327
350
359
372
394
416
438
461
483
505
527
549
572
581
594
616
638
660
683
705
727
749
771
794
803
816
838
860
882
905
927
949
971
993
1016
1025
1038
1060
1082
1104
1128
1150
1172
1194
1216
1239
1248
1261
1283
1305
1327
1350
1372
1394
1416
1438
1461
1470
1483
1505
1527
1549
1572
1594
1616
1638
1660
1683
1692
1705
1727
1749
1771
1794
1816
1838
1860
1882
1905
1914
1927
1949
1971
1993
18
40
62
84
106
129
148
151
173
195
217
240
262
284
306
328
337
351
370
373
395
417
439
462
484
506
528
550
573
592
595
617
639
661
684
706
728
750
772
795
814
817
839
861
883
906
928
950
972
994
1017
1036
1039
1061
1083
1105
1129
1151
1173
1195
1217
1240
1259
1262
1284
1306
1328
1351
1373
1395
1417
1439
1462
1481
1484
1506
1528
1550
1573
1595
1617
1639
1661
1684
1703
1706
1728
1750
1772
1795
1817
1839
1861
1883
1906
1925
1928
1950
1972
1994
19
41
63
85
107
130
152
159
174
196
218
241
263
285
307
329
352
374
381
396
418
440
448
463
485
507
529
551
574
596
603
618
640
662
685
707
729
751
773
796
818
825
840
862
884
907
929
951
973
995
1018
1040
1047
1062
1084
1106
1130
1152
1174
1196
1218
1241
1263
1270
1285
1307
1329
1352
1374
1396
1418
1440
1463
1485
1492
1507
1529
1551
1574
1596
1618
1640
1662
1685
1707
1714
1729
1751
1773
1796
1818
1840
1862
1884
1907
1929
1936
1951
1973
1995
20
42
64
86
108
131
153
170
175
197
219
242
264
286
308
330
353
375
392
397
419
441
464
486
508
530
552
559
575
597
614
619
641
663
686
708
730
752
774
797
819
836
841
863
885
908
930
952
974
996
1019
1041
1058
1063
1085
1107
1131
1153
1175
1197
1219
1242
1264
1281
1286
1308
1330
1353
1375
1397
1419
1441
1464
1486
1503
1508
1530
1552
1575
1597
1619
1641
1663
1686
1708
1725
1730
1752
1774
1797
1819
1841
1863
1885
1908
1930
1947
1952
1974
1996
21
43
65
87
109
132
154
176
181
198
220
243
265
287
309
331
354
376
398
403
420
442
465
487
509
531
553
576
598
620
625
642
664
670
687
709
731
753
775
798
820
842
847
864
886
909
931
953
975
997
1020
1042
1064
1069
1086
1108
1132
1154
1176
1198
1220
1243
1265
1287
1292
1309
1331
1354
1376
1398
1420
1442
1465
1487
1509
1514
1531
1553
1576
1598
1620
1642
1664
1687
1709
1731
1736
1753
1775
1798
1820
1842
1864
1886
1909
1931
1953
1958
1975
1997
22
44
66
88
110
133
155
177
192
199
221
244
266
288
310
332
355
377
399
414
421
443
466
488
510
532
554
577
599
621
636
643
665
688
710
732
754
776
781
799
821
843
858
865
887
910
932
954
976
998
1021
1043
1065
1080
1087
1109
1133
1155
1177
1199
1221
1244
1266
1288
1303
1310
1332
1355
1377
1399
1421
1443
1466
1488
1510
1525
1532
1554
1577
1599
1621
1643
1665
1688
1710
1732
1747
1754
1776
1799
1821
1843
1865
1887
1910
1932
1954
1969
1976
1998
23
45
67
89
111
134
156
178
200
203
222
245
267
289
311
333
356
378
400
422
425
444
467
489
511
533
555
578
600
622
644
647
666
689
711
733
755
777
800
822
844
866
869
888
892
911
933
955
977
999
1022
1044
1066
1088
1091
1110
1134
1156
1178
1200
1222
1245
1267
1289
1311
1314
1333
1356
1378
1400
1422
1444
1467
1489
1511
1533
1536
1555
1578
1600
1622
1644
1666
1689
1711
1733
1755
1758
1777
1800
1822
1844
1866
1888
1911
1933
1955
1977
1980
1999
24
46
68
90
112
135
157
179
201
214
223
246
268
290
312
334
357
379
401
423
436
445
468
490
512
534
556
579
601
623
645
658
667
690
712
734
756
778
801
823
845
867
880
889
912
934
956
978
1000
1003
1023
1045
1067
1089
1102
1111
1135
1157
1179
1201
1223
1246
1268
1290
1312
1325
1334
1357
1379
1401
1423
1445
1468
1490
1512
1534
1547
1556
1579
1601
1623
1645
1667
1690
1712
1734
1756
1769
1778
1801
1823
1845
1867
1889
1912
1934
1956
1978
1991
2000
1
2
25
47
69
91
113
136
158
180
202
224
225
247
269
291
313
335
358
380
402
424
446
447
469
491
513
535
557
580
602
624
646
668
669
691
713
735
757
779
802
824
846
868
890
891
913
935
957
979
1001
1024
1046
1068
1090
1112
1113
1114
1136
1158
1180
1202
1224
1247
1269
1291
1313
1335
1336
1358
1380
1402
1424
1446
1469
1491
1513
1535
1557
1558
1580
1602
1624
1646
1668
1691
1713
1735
1757
1779
1780
1802
1824
1846
1868
1890
1913
1935
1957
1979
];
for col= 1:2000
%   Mx_blade_sorted(:,col)=Mx(:,INDEX(col,1));
   Mx_Tbase_sorted(:,col)=Mx_Tbase(:,INDEX(col,1));
end
%  save('Mx_blade_sorted.mat','Mx_blade_sorted');
save('Mx_Tbase_sorted.mat','Mx_Tbase_sorted');
Neq=600;
DELm10=zeros(100,20);
m=3;
for    t_i=1:20
for    seed=1:100
       cyc=[];
       ran=[];
       counter=(t_i-1)*100+seed;
       c=rainflow(Mx_Tbase_sorted(:,counter));
%      ran=c(find(c(:,2)>2),2)/2;
       ran=c(:,2)/2;
%      cyc=c(find(c(:,2)>2),1);
       cyc=c(:,1);
%      cycles=[cycles;cyc];
%      RANGE=[RANGE;ran];
       DELm10(seed,t_i)=(sum(cyc.*ran.^m))/Neq;
end
end
cd('C:\Users\shmoz\OneDrive - Danmarks Tekniske Universitet\Paper 2\DTU 10MW_turb sampling\20samples\Tower\m_3\lowTI\');
save('DELm10lgn_lowTI.mat','DELm10')

DELm10=zeros(100,20);
m=4;
for    t_i=1:20
for    seed=1:100
       cyc=[];  
       ran=[];
       counter=(t_i-1)*100+seed;
       c=rainflow(Mx_Tbase_sorted(:,counter));
%      ran=c(find(c(:,2)>2),2)/2;
       ran=c(:,2)/2;
%      cyc=c(find(c(:,2)>2),1);
       cyc=c(:,1);
%      cycles=[cycles;cyc];
%      RANGE=[RANGE;ran];
       DELm10(seed,t_i)=(sum(cyc.*ran.^m))/Neq;
end
end
cd('C:\Users\shmoz\OneDrive - Danmarks Tekniske Universitet\Paper 2\DTU 10MW_turb sampling\20samples\Tower\m_4\lowTI\');
save('DELm10lgn_lowTI.mat','DELm10')

DELm10=zeros(100,20);
m=5;
for    t_i=1:20
for    seed=1:100
       cyc=[];
       ran=[];
       counter=(t_i-1)*100+seed;
       c=rainflow(Mx_Tbase_sorted(:,counter));
%      ran=c(find(c(:,2)>2),2)/2;
       ran=c(:,2)/2;
%      cyc=c(find(c(:,2)>2),1);
       cyc=c(:,1);
%      cycles=[cycles;cyc];
%      RANGE=[RANGE;ran];
       DELm10(seed,t_i)=(sum(cyc.*ran.^m))/Neq;
end
end
cd('C:\Users\shmoz\OneDrive - Danmarks Tekniske Universitet\Paper 2\DTU 10MW_turb sampling\20samples\Tower\m_5\lowTI\');
save('DELm10lgn_lowTI.mat','DELm10')


